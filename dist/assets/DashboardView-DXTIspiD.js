import{d as U,g as f,k as j,u as N,o as i,c as r,a as e,t as h,q as w,v as T,F as B,r as C,j as D,_ as J,h as S,i as A,x as L,b as I,y as F,z as M}from"./index-CRKlmQqA.js";import{f as V,d as P}from"./JobService-DJwCb_gt.js";import{u as W}from"./userStore-CnkZcyTt.js";const q={key:0,class:"popup-overlay"},H={class:"popup-content"},O={class:"job-form"},R=["onUpdate:modelValue"],K=["onClick"],G=["onUpdate:modelValue"],Q=["onClick"],X=["src"],Y=U({__name:"JobUpdatePopup",props:{job:{type:Object,required:!1,default:()=>({title:"",jobType:"",description:"",expectations:[],work:[],imageData:null})},isVisible:{type:Boolean,required:!0}},emits:["close","save"],setup(p,{emit:n}){const s=p,l=n,t=f({...s.job}),a=f(s.job.imageData?`data:image/png;base64,${s.job.imageData}`:null),u=j(()=>!!s.job&&!!s.job.title),y=c=>{const o=c.target,b=o!=null&&o.files?o.files[0]:null;if(b){const d=new FileReader;d.onload=_=>{var z;const E=(z=_.target)==null?void 0:z.result;typeof E=="string"&&(a.value=E,t.value.imageData=a.value)},d.readAsDataURL(b)}},$=()=>t.value.expectations.push(""),k=c=>t.value.expectations.splice(c,1),m=()=>t.value.work.push(""),v=c=>t.value.work.splice(c,1),g=()=>{l("save",t.value),x()},x=()=>l("close");return N(()=>s.job,c=>{t.value={...c},a.value=c.imageData?`data:image/png;base64,${c.imageData}`:null},{immediate:!0}),(c,o)=>p.isVisible?(i(),r("div",q,[e("div",H,[e("button",{class:"close-button",onClick:x},"x"),e("h2",null,h(u.value?"Job Bearbeiten":"Job Erstellen"),1),e("div",O,[o[3]||(o[3]=e("label",{for:"jobTitle"},"Job Title:",-1)),w(e("input",{id:"jobTitle",type:"text","onUpdate:modelValue":o[0]||(o[0]=b=>t.value.title=b),placeholder:"Job Titel",class:"input-field"},null,512),[[T,t.value.title]]),o[4]||(o[4]=e("label",{for:"jobType"},"Job Type:",-1)),w(e("input",{id:"jobType",type:"text","onUpdate:modelValue":o[1]||(o[1]=b=>t.value.jobType=b),placeholder:"Job Typ",class:"input-field"},null,512),[[T,t.value.jobType]]),o[5]||(o[5]=e("label",{for:"description"},"Beschreibung:",-1)),w(e("textarea",{id:"description","onUpdate:modelValue":o[2]||(o[2]=b=>t.value.description=b),placeholder:"Beschreibung eingeben",class:"input-field"},null,512),[[T,t.value.description]]),o[6]||(o[6]=e("label",null,"Unsere Erwartungen:",-1)),(i(!0),r(B,null,C(t.value.expectations,(b,d)=>(i(),r("div",{key:"expectation-"+d,class:"list-item"},[w(e("input",{type:"text","onUpdate:modelValue":_=>t.value.expectations[d]=_,placeholder:"Erwartung hinzufÃ¼gen",class:"input-field small"},null,8,R),[[T,t.value.expectations[d]]]),e("button",{onClick:_=>k(d)},"x",8,K)]))),128)),e("button",{onClick:$,class:"btn small"},"Erwartung hinzufÃ¼gen"),o[7]||(o[7]=e("label",null,"Dein Alltag bei uns:",-1)),(i(!0),r(B,null,C(t.value.work,(b,d)=>(i(),r("div",{key:"work-"+d,class:"list-item"},[w(e("input",{type:"text","onUpdate:modelValue":_=>t.value.work[d]=_,placeholder:"TÃ¤tigkeit hinzufÃ¼gen",class:"input-field small"},null,8,G),[[T,t.value.work[d]]]),e("button",{onClick:_=>v(d)},"x",8,Q)]))),128)),e("button",{onClick:m,class:"btn small"},"TÃ¤tigkeit hinzufÃ¼gen"),o[8]||(o[8]=e("label",{for:"imageUpload"},"Bild hochladen:",-1)),e("input",{type:"file",id:"imageUpload",onChange:y,class:"input-field"},null,32),a.value?(i(),r("img",{key:0,src:a.value,alt:"Job Bild",class:"preview-image"},null,8,X)):D("",!0),e("button",{onClick:g,class:"btn primary"},h(u.value?"Speichern":"Erstellen"),1)])])])):D("",!0)}}),Z=J(Y,[["__scopeId","data-v-35b77c55"]]),ee={class:"dashboard-jobboard"},te={class:"jobboard-body"},oe={class:"table table-striped table-hover"},ae={class:"job-elements"},se=["onClick"],le=["onClick"],ne={key:0,class:"modal fade bd-example-modal-sm",tabindex:"-1",role:"dialog","aria-labelledby":"mySmallModalLabel","aria-hidden":"true"},ie=U({__name:"JobBoard",setup(p){const n=f([]),s=f(!1),l=f(null),t=f(!1),a=m=>{l.value=m,s.value=!0},u=()=>{s.value=!1,l.value=null};S(async()=>{n.value=await V()});const y=async m=>{await P(m),t.value=!0,setTimeout(()=>{t.value=!1},5e3),n.value=await V()},$=async()=>{console.log("Function is disabled."),setTimeout(()=>{t.value=!1},5e3),n.value=await V()},k=async()=>{s.value=!0,console.log("Function is disabled.")};return(m,v)=>(i(),r("div",ee,[e("div",{class:"jobboard-header"},[v[0]||(v[0]=e("div",{class:"jobboard-title"},[e("h4",null,"Aktuelle Stellenanzeigen")],-1)),e("div",{class:"jobboard-elements"},[e("button",{type:"button",class:"btn btn-success",onClick:k},"HinzufÃ¼gen"),e("button",{type:"button",class:"btn btn-danger",onClick:$},"Alle Entfernen")])]),e("div",te,[e("table",oe,[v[1]||(v[1]=e("thead",null,[e("tr",null,[e("th",null,"Stelle"),e("th",null,"Art der BeschÃ¤ftigung"),e("th",null,"Ort"),e("th",null,"Aktionen")])],-1)),e("tbody",null,[(i(!0),r(B,null,C(n.value,g=>(i(),r("tr",{key:g.id},[e("td",null,h(g.title),1),e("td",null,h(g.jobType),1),e("td",null,h(g.location),1),e("td",ae,[e("button",{class:"btn btn-primary btn-sm",onClick:x=>a(g)},"Bearbeiten",8,se),e("button",{class:"btn btn-danger btn-sm",onClick:x=>y(g.id)},"LÃ¶schen",8,le)])]))),128))])]),t.value?(i(),r("div",ne,v[2]||(v[2]=[e("div",{class:"modal-dialog modal-sm"},[e("div",{class:"modal-content"},[e("p",null,"Job wurde erfolgreich gelÃ¶scht.")])],-1)]))):D("",!0),s.value?(i(),A(Z,{key:1,job:l.value||{title:"",jobType:"",description:"",location:"",expectations:[],work:[],imageData:null},isVisible:s.value,onClose:u,onSave:k},null,8,["job","isVisible"])):D("",!0)])]))}}),re=J(ie,[["__scopeId","data-v-1cf5e1bf"]]),de={setup(){const p=W(),n=f(null),s=j(()=>p.getUser),l=j(()=>{var a;return((a=s.value)==null?void 0:a.firstName)??""}),t=j(()=>{var a;return((a=s.value)==null?void 0:a.lastName)??""});return S(()=>{if(!s.value){const a=localStorage.getItem("dashboard");if(a)try{const u=a.split(".")[1],y=atob(u),k=JSON.parse(y).username;p.fetchUserData(k).catch(m=>{n.value="Fehler beim Laden der Benutzerdaten.",console.error(m)})}catch(u){n.value="UngÃ¼ltiges Dashboard-Token.",console.error(u)}else n.value="Kein Dashboard-Token im localStorage gefunden."}}),{user:s,firstName:l,lastName:t,errorMessage:n}}},ue={class:"welcome-header"},ce={class:"welcome-title"},be={key:0,class:"dashboard-title"},pe={key:1,class:"error-message"},me={key:2,class:"loading-message"};function ve(p,n,s,l,t,a){return i(),r("div",ue,[e("div",ce,[l.user?(i(),r("h1",be,"ðŸ‘‹ Willkommen, "+h(l.user.firstName)+" "+h(l.user.lastName)+"!",1)):l.errorMessage?(i(),r("div",pe,h(l.errorMessage),1)):(i(),r("div",me,"Lade Benutzerdaten..."))])])}const ge=J(de,[["render",ve],["__scopeId","data-v-e92938d6"]]),he={class:"dashboard-view"},_e={class:"dashboard-content"},fe={class:"dashboard-header"},ke={class:"dashboard-body"},ye=U({__name:"DashboardView",setup(p){const n=F(),s=async()=>{const a=localStorage.getItem("dashboard");if(!a)console.log("Der Token ist nicht valid! - DashboardView"),await n.push("/login");else try{(await M.get("/api/auth/validate-token",{headers:{Authorization:`Bearer ${a}`}})).status!==200&&(localStorage.removeItem("dashboard"),await n.push("/login"))}catch{localStorage.removeItem("dashboard"),await n.push("/login")}},l=()=>{clearTimeout(t),t=setTimeout(()=>{localStorage.removeItem("dashboard"),n.push("/login")},72e5)};let t;return S(()=>{s(),window.addEventListener("mousemove",l),l()}),L(()=>{window.removeEventListener("mousemove",l),clearTimeout(t)}),(a,u)=>(i(),r("div",he,[e("div",_e,[e("div",fe,[I(ge)]),e("div",ke,[I(re)])])]))}}),xe=J(ye,[["__scopeId","data-v-e3679d81"]]);export{xe as default};
